import"./hoisted.35da0890.js";let V;V=window.location.pathname.slice(1);console.log("Current URL:"+V);var $=document.getElementById("fileInput");$.addEventListener("change",e=>{H()});var R=document.getElementById("contact_form");R.addEventListener("submit",G);var c=document.querySelector('input[name="emailaddress"]');c.addEventListener("blur",Z);function Z(){const e=c.value.trim(),t=c.nextElementSibling;if(e===""){U(t),c.style.borderColor="";return}w(e)?(U(t),c.style.borderColor=""):(S(c),J(t,"Please enter a valid email address.",c))}const D="c9025a4d07020e1",F="78509ec3e33e18e";function S(e){e.style.borderColor!=="red"?e.style.borderColor="red":e.style.borderColor=""}function b(e){e.addEventListener("focus",()=>{e.style.borderColor=""})}function G(e){e.preventDefault();const t=document.querySelector('input[name="full_name"]'),n=document.querySelector('input[name="emailaddress"]'),o=document.querySelector('textarea[name="message"]'),_=document.querySelector('input[name="phone"]');t.value.trim();const s=n.value.trim(),f=o.value.trim();if(_.value.trim(),b(t),b(n),b(o),b(_),(s===""||!w(s))&&(S(n),J(n.nextElementSibling,"Please enter a valid email address.",n)),f===""&&S(o),s===""||f==="")return;const p=document.getElementById("fileInput").files[0],m=new URLSearchParams(window.location.search).get("page"),r=m||"",y=m?"Demo":"General";if(p){if(w(s)){const a=new XMLHttpRequest,l="https://sanskar.frappe.cloud/api/method/upload_file";a.open("POST",l,!0),a.setRequestHeader("Accept","application/json"),a.onload=function(){if(a.status===200){var h=JSON.parse(a.response),g=h.message.file_url;const A=new FormData(e.target),u=Object.fromEntries(A.entries());A.set("data",JSON.stringify(u));var i=u.full_name,P=u.emailaddress,k=u.phone,j=u.message;W().then(L=>{let{browserName:N,device:T}=B();fetch("https://sanskar.frappe.cloud/api/resource/Enquiry",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`token ${D}:${F}`},body:JSON.stringify({first_name:i,email:P,phone:k,message:j,document:g,enquiry_source:"Website Enquiry",demo_for:r,query_type:y,ip:L,browser_name:N,device:T,website_page_name:"Contact Us"})}).then(v=>{v.status===200?window.location.href="/thank-you":(console.log("failed to post form",v),z(i,P,k,j,"Website Enquiry",r,y,L,N,T,"Contact Us"),alert("Failed to submit data. Please try after some time."))}).catch(v=>{console.log(v)})})}else alert("File upload failed. Please try again later.")},a.onerror=function(){alert("An error occurred while uploading the file.")};const d=new FormData;d.append("file",p),a.send(d),e.preventDefault()}}else if(w(s)){const a=new FormData(e.target),l=Object.fromEntries(a.entries());a.set("data",JSON.stringify(l));var x=l.full_name,I=l.emailaddress,E=l.phone,O=l.message;W().then(d=>{let{browserName:h,device:g}=B();fetch("https://sanskar.frappe.cloud/api/resource/Enquiry",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`token ${D}:${F}`},body:JSON.stringify({first_name:x,email:I,phone:E,message:O,enquiry_source:"Website Enquiry",demo_for:r,query_type:y,ip:d,browser_name:h,device:g,website_page_name:"Contact Us"})}).then(i=>{i.status===200?(console.log(i),window.location.href="/thank-you"):(console.log("failed to post form",i),z(x,I,E,O,"Website Enquiry",r,y,d,h,g,"Contact Us"),alert("Failed to submit data. Please try after some time."))}).catch(i=>{console.log("error",i)})})}}function w(e){return/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(String(e).toLowerCase())}function J(e,t,n){!e||!e.classList.contains("error-message")?(e=document.createElement("p"),e.textContent=t,e.classList.add("error-message"),e.style.color="red",e.style.fontSize="0.8rem",e.style.marginTop="0.2rem",e.style.marginBottom="0",n.parentNode.insertBefore(e,n.nextSibling)):e.textContent=t}function U(e){e&&e.classList.contains("error-message")&&e.remove()}function H(){var e=document.getElementById("fileInput"),t=e.value,n=/(\.jpg|\.pdf|\.png|\.docx|\.txt)$/i;if(!n.exec(t))return alert("Invalid file type only allow .jpg | .pdf | .png | .docx | .txt"),e.value="",!1}function B(){const e=navigator.userAgent;var t="Unknown";e.indexOf("Chrome")!==-1?t="Google Chrome":e.indexOf("Firefox")!==-1?t="Mozilla Firefox":e.indexOf("Safari")!==-1?t="Apple Safari":e.indexOf("Edg")!==-1?t="Microsoft Edge":(e.indexOf("MSIE")!==-1||e.indexOf("Trident")!==-1)&&(t="Internet Explorer");const n=window.innerWidth;var o="Unknown";return n<=576?o="Mobile":n<=992?o="Tablet":n<=1200?o="Laptop":o="Desktop",{browserName:t,device:o}}function W(){return fetch("https://api.ipify.org?format=json").then(e=>e.json()).then(e=>e.ip).catch(e=>(console.error("Error fetching IP address:",e),null))}function z(e="",t="",n="",o="",_="",s="",f="",q="",p="",C="",m=""){console.log("sending email notification..."),fetch("https://sanskartechnolab.com/api/method/astro_sanskar.api.send_form_failed_notification",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({full_name:e,email:t,phone:n,message:o,enquiry_source:"Website Enquiry",demoForValue:s,queryTypeValue:f,ip:q,browser_name:p,device:C,response:m,page_name:"Contact Us"})}).then(r=>{r.status===200?console.log("email notification sent."):(console.log("failed to send email notification",r),alert("We are unable to process your request. please send your requirements on info@sanskartechnolab.com"))}).catch(r=>{console.log("error",r)})}
