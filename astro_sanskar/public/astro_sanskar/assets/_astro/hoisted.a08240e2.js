import"./hoisted.78da099e.js";var U=document.getElementById("fileInput");U.addEventListener("change",e=>{Z()});var G=document.getElementById("contact_form");G.addEventListener("submit",K);var i=document.querySelector('input[name="emailaddress"]');i.addEventListener("blur",H);function H(){const e=i.value.trim(),t=i.nextElementSibling;if(e===""){V(t),i.style.borderColor="";return}R(e)?(V(t),i.style.borderColor=""):(S(i),$(t,"Please enter a valid email address."))}const T="c9025a4d07020e1",D="78509ec3e33e18e";function S(e){e.style.borderColor!=="red"?e.style.borderColor="red":e.style.borderColor=""}function I(e){e.addEventListener("focus",()=>{e.style.borderColor=""})}function K(e){e.preventDefault();var t=grecaptcha.getResponse();if(console.log("response",t),t.length===0){document.getElementById("recaptcha-error").style.display="block";return}document.getElementById("recaptcha-error").style.display="none",grecaptcha.getResponse(),a();function a(){const n=document.getElementById("recaptcha-error");n.style.display="none"}const o=document.querySelector('input[name="full_name"]'),c=document.querySelector('input[name="emailaddress"]'),d=document.querySelector('textarea[name="message"]'),y=document.querySelector('input[name="phone"]'),h=o.value.trim(),u=c.value.trim(),g=d.value.trim();if(y.value.trim(),I(o),I(c),I(d),I(y),h===""&&S(o),(u===""||!R(u))&&(S(c),$(c.nextElementSibling,"Please enter a valid email address.")),g===""&&S(d),h===""||u===""||g==="")return;const s=document.getElementById("fileInput").files[0],x=new URLSearchParams(window.location.search).get("page"),v=x||"",b=x?"Demo":"General";if(s){const n=new XMLHttpRequest,l="https://sanskar.frappe.cloud/api/method/upload_file";n.open("POST",l,!0),n.setRequestHeader("Accept","application/json"),n.onload=function(){if(n.status===200){var w=JSON.parse(n.response),E=w.message.file_url;const B=new FormData(e.target),p=Object.fromEntries(B.entries());B.set("data",JSON.stringify(p));var r=p.full_name,P=p.emailaddress,j=p.phone,N=p.message;z().then(A=>{let{browserName:F,device:L}=W();fetch("https://sanskar.frappe.cloud/api/resource/Enquiry",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`token ${T}:${D}`},body:JSON.stringify({first_name:r,email:P,phone:j,message:N,document:E,enquiry_source:"Website Enquiry",demo_for:v,query_type:b,ip:A,browser_name:F,device:L})}).then(m=>{m.status===200?window.location.href="/thank-you":(console.log("failed to post form",m),J(r,P,j,N,"Website Enquiry",v,b,A,F,L,m),alert("Failed to submit data. Please try after some time."))}).catch(m=>{console.log(m)})})}else alert("File upload failed. Please try again later.")},n.onerror=function(){alert("An error occurred while uploading the file.")};const f=new FormData;f.append("file",s),n.send(f),e.preventDefault()}else{const n=new FormData(e.target),l=Object.fromEntries(n.entries());n.set("data",JSON.stringify(l));var _=l.full_name,O=l.emailaddress,C=l.phone,k=l.message;z().then(f=>{let{browserName:w,device:E}=W();fetch("https://sanskar.frappe.cloud/api/resource/Enquiry",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`token ${T}:${D}`},body:JSON.stringify({first_name:_,email:O,phone:C,message:k,enquiry_source:"Website Enquiry",demo_for:v,query_type:b,ip:f,browser_name:w,device:E})}).then(r=>{r.status===200?(console.log(r),window.location.href="/thank-you"):(console.log("failed to post form",r),J(_,O,C,k,"Website Enquiry",v,b,f,w,E,r),alert("Failed to submit data. Please try after some time."))}).catch(r=>{console.log("error",r)})})}}function R(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}function $(e,t){!e||!e.classList.contains("error-message")?(e=document.createElement("p"),e.textContent=t,e.classList.add("error-message"),e.style.color="red",e.style.fontSize="0.8rem",e.style.marginTop="0.2rem",e.style.marginBottom="0",i.parentNode.insertBefore(e,i.nextSibling)):e.textContent=t}function V(e){e&&e.classList.contains("error-message")&&e.remove()}function Z(){var e=document.getElementById("fileInput"),t=e.value,a=/(\.jpg|\.pdf|\.png|\.docx|\.txt)$/i;if(!a.exec(t))return alert("Invalid file type only allow .jpg | .pdf | .png | .docx | .txt"),e.value="",!1}function W(){const e=navigator.userAgent;var t="Unknown";e.indexOf("Chrome")!==-1?t="Google Chrome":e.indexOf("Firefox")!==-1?t="Mozilla Firefox":e.indexOf("Safari")!==-1?t="Apple Safari":e.indexOf("Edg")!==-1?t="Microsoft Edge":(e.indexOf("MSIE")!==-1||e.indexOf("Trident")!==-1)&&(t="Internet Explorer");const a=window.innerWidth;var o="Unknown";return a<=576?o="Mobile":a<=992?o="Tablet":a<=1200?o="Laptop":o="Desktop",{browserName:t,device:o}}function z(){return fetch("https://api.ipify.org?format=json").then(e=>e.json()).then(e=>e.ip).catch(e=>(console.error("Error fetching IP address:",e),null))}function J(e="",t="",a="",o="",c="",d="",y="",h="",u="",g="",q=""){console.log("sending email notification..."),fetch("http://sanskar.com:8000/api/method/astro_sanskar.api.send_form_failed_notification",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({full_name:e,email:t,phone:a,message:o,enquiry_source:"Website Enquiry",demoForValue:d,queryTypeValue:y,ip:h,browser_name:u,device:g,response:q,page_name:"Contact Us"})}).then(s=>{s.status===200?console.log("email notification sent."):(console.log("failed to send email notification",s),alert("We are unable to process your request. please send your requirements on info@sanskartechnolab.com"))}).catch(s=>{console.log("error",s)})}
